## 基础接口

**Reader接口**：读文件接口，将数据流中的len个字节读入到p。

```go
type Reader interface {
    Read(p []byte)(n int, err error)
}
```

**Writer接口**：写文件接口，将p中的数据写入到对象数据流中。

```go
type Writer interface {
    Write(p []byte)(n int, err error)
}
```

**Seeker接口**：定位（指针）接口，设置下一次读写操作的指针。

```go
type Seeker interface {
    Seek(offset int64, whence int)(n int, err error)
}
/*
whence的取值：
    SEEK_SET int = 0 // 从文件开始处偏移。
    SEEK_CUR int = 1 // 从当前位置处偏移。
    SEEK_END int = 2 // 从文件结尾处偏移。
offset：偏移量。
*/
```

**Close接口**：关闭文件接口。

```go
type Closer interface{
    Close() error
}
```

## 操作常量

```go
O_RDONLY int = syscall.O_RDONLY // 以只读方式打开。
O_WRONLY int = syscall.O_WRONLY // 以只写方式打开。
O_RDWR   int = syscall.O_RDWR   // 以读写方式打开。
O_APPEND int = syscall.O_APPEND // 以追加写方式打开。
O_CREATE int = syscall.O_CREAT  // 若文件不存在则创建。
O_EXCL   int = syscall.O_EXCL   // 创建文件（要求文件必须不存在）。
O_SYNC   int = syscall.O_SYNC   // 以异步方式打开。
O_TRUNC  int = syscall.O_TRUNC  // 覆盖写方式打开。
```

## 读写文件

### 读文件常用方法

**os.openFile()：**用于打开文件获取到```*os.file```。

**bufio.newReader(f)：**将文件变为reader。

**bufio.newWriter(f)：**将文件变为writer。

**reader.ReadString('\n')：**以指定字符为结束符读取字符串；此外ReadLine、ReadBytes、ReadSlice等。

**ioutil.ReadAll(f)：**直接读取整个文件，os.ReadFile同此效果。

**os.ReadDir('./')：**读取文件夹，获取目标文件夹下的文件信息。

### 写文件常用方法

**os.openFile()：**用于打开文件，获取到*file。

**f.seek()：**挪动光标位置。

**f.WriteString()：**直接写入。

**bufio.NewWriter()**：

- writer.WriteString()：写入内存。
- write.Flush()：缓存内容刷新到文件。

### 示例

**示例1：**原生读、写、定位文件。

```go
func File(){
	file,err := os.OpenFile("./test.txt", os.O_CREATE | os.O_RDWR, 777)
	if err != nil {
		fmt.Println(err.Error())
		return
	}
	defer file.Close()

	z := 0
	for {
		// 读缓存数组
		buffArr := make([]byte,50)
		// 读文件内容到读缓存数组
		n, err := file.Read(buffArr)

		if z < 5 {
			// 从当前位置处向文件开始出偏移12个字节，共偏移5次
			file.Seek(-12, io.SeekCurrent)
			z++
		}

		if err != nil {
			fmt.Println(err)
			return
		}
		fmt.Printf("Read: %d bytes: %s\n", n, string(buffArr))
	}
}
```

**示例2：**按指定符号作为结束符读取（bufio.Reader）。

```go
func File(){
	file,err := os.OpenFile("./test.txt", os.O_CREATE | os.O_RDWR, 777)
	if err != nil {
		fmt.Println(err.Error())
		return
	}
	defer file.Close()

	reader := bufio.NewReader(file)
	for {
		str, err := reader.ReadString('\n')
		if err != nil {
			fmt.Println(err.Error())
			return
		}
		fmt.Println(str)
	}
}
```

**示例3：**按行读取（bufio.Reader）。

```go
func File(){
	file,err := os.OpenFile("./test.txt", os.O_CREATE | os.O_RDWR, 777)
	if err != nil {
		fmt.Println(err.Error())
		return
	}
	defer file.Close()

	reader := bufio.NewReader(file)
	for {
		// isPrefix：是否是前缀，缓存读满但未读完一行。
		str, isPrefix, err := reader.ReadLine()
		if err != nil {
			fmt.Println(err.Error())
			return
		}
		fmt.Println(string(str),isPrefix)
	}
}
```

**示例4：**读取全部。

```go
func File(){
	file,err := os.OpenFile("./test.txt", os.O_CREATE | os.O_RDWR, 777)
	if err != nil {
		fmt.Println(err.Error())
		return
	}
	defer file.Close()

	buf, _ := ioutil.ReadAll(file)
	fmt.Println(string(buf))
}
```

**示例5：**读文件夹。

```go
func File(){
	dir, err := os.ReadDir("./")
	if err != nil {
		fmt.Println(err.Error())
		return
	}
	for _, entry := range dir {
		fmt.Println(entry.Info())
		fmt.Println(entry.Name())
		fmt.Println(entry.IsDir())
		fmt.Println(entry.Type())
	}
}
```

**示例6：**写文件（bufio.Writer）。

```go
func File(){
	file, err := os.OpenFile("./test.txt", os.O_CREATE | os.O_RDWR, 0777)
	if err != nil {
		fmt.Println(err.Error())
		return
	}

	reader := bufio.NewReader(file)
	writer := bufio.NewWriter(file)

	n := 0
	for {
		n++
		str, err := reader.ReadString('\n')
		if err != nil {
			fmt.Println(err.Error())
			break
		}
		fmt.Println(str)
		writer.WriteString("line " + strconv.Itoa(n) + ": " + str)
	}
	file.Seek(0, io.SeekStart)
	writer.Flush()
}
```

## 复制文件

```go
func File(){
	file1, _ := os.OpenFile("./test.txt", os.O_CREATE | os.O_RDWR, 0777)
	file2, _ := os.OpenFile("./test_new.txt", os.O_CREATE | os.O_RDWR, 0777)

	io.Copy(file2, file1)
}
```

